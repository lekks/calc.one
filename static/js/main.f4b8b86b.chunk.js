(this.webpackJsonprpcalc=this.webpackJsonprpcalc||[]).push([[0],{32:function(t,e,n){},38:function(t,e,n){},39:function(t,e,n){"use strict";n.r(e);var s,i=n(0),c=n(8),a=n.n(c),r=n(21),u=n.n(r),o=(n(32),n(3)),l=n(4),h=n(14),b=n(13),d=function(t){Object(h.a)(n,t);var e=Object(b.a)(n);function n(t){var s;return Object(o.a)(this,n),(s=e.call(this,t)).onClick=function(){s.props.subject.next({type:s.props.action,payload:s.props.tag})},s.onKeyDown=function(t){t.key===s.props.keybind&&s.onClick()},document.addEventListener("keydown",s.onKeyDown),s}return Object(l.a)(n,[{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyDown)}},{key:"render",value:function(){return Object(i.jsx)("div",{onClick:this.onClick,className:"Button",children:this.props.caption})}}]),n}(a.a.Component),p=(n(33),n(22)),j=function(t){var e=Number(t.expression.result.toFixed(6)),n=isNaN(e)?"?":String(e),s="".concat(t.expression.texFormula,"=").concat(n);return Object(i.jsx)("div",{className:"Expression",children:Object(i.jsx)(p.BlockMath,{math:s})})},x=function(t){Object(h.a)(n,t);var e=Object(b.a)(n);function n(t){var s;return Object(o.a)(this,n),(s=e.call(this,t)).subscription=void 0,s.state={expressions:[]},s.subscription=t.subject.subscribe((function(t){s.setState({expressions:t})})),s}return Object(l.a)(n,[{key:"componentWillUnmount",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"render",value:function(){var t=this.state.expressions.slice().reverse();return Object(i.jsx)("div",{className:"Stack",children:t.map((function(t,e){return Object(i.jsxs)(a.a.Fragment,{children:[e?Object(i.jsx)("hr",{}):null,Object(i.jsx)(j,{expression:t})]},e)}))})}}]),n}(a.a.Component),k=function(t){Object(h.a)(n,t);var e=Object(b.a)(n);function n(t){var s;return Object(o.a)(this,n),(s=e.call(this,t)).subscription=void 0,s.state={text:""},s.subscription=t.subject.subscribe((function(t){s.setState({text:t})})),s}return Object(l.a)(n,[{key:"componentWillUnmount",value:function(){this.subscription.unsubscribe()}},{key:"render",value:function(){return Object(i.jsx)("div",{className:"Input",children:this.state.text})}}]),n}(a.a.Component),v=(n(38),n(19)),O=n(24),f=n(40),y=n(43),E=n(41),g=n(42),m=function(){function t(){Object(o.a)(this,t),this.symbolInput=new O.a,this.stringInput=new O.a,this.expression=new f.a(""),this.stringInput.pipe(Object(y.a)()).subscribe(this.symbolInput),this.symbolInput.pipe(Object(E.a)((function(e){return t.allowedSymbols.includes(e)})),Object(g.a)(t.symbolReducer,"")).subscribe(this.expression)}return Object(l.a)(t,[{key:"getInput",value:function(){return this.expression.getValue()}},{key:"notEmpty",value:function(){return 0!==this.expression.getValue().length}},{key:"addSymbol",value:function(t){return this.symbolInput.next(t)}}],[{key:"symbolReducer",value:function(e,n){return n===t.BS_SYMBOL?e.length>0?e.slice(0,-1):e:n===t.CLEAR_SYMBOL?"":(","===n&&(n="."),"."===n&&-1!==e.indexOf(n)?e:e+n)}}]),t}();m.CLEAR_SYMBOL="DEL",m.BS_SYMBOL="BS",m.allowedSymbols=[".",",","0","1","2","3","4","5","6","7","8","9",m.CLEAR_SYMBOL,m.BS_SYMBOL],function(t){t[t.PLUS_MINUS=0]="PLUS_MINUS",t[t.MULT__DIV=1]="MULT__DIV",t[t.FUNC=2]="FUNC",t[t.NUMBER=3]="NUMBER"}(s||(s={}));var N=function(){function t(e){Object(o.a)(this,t),this.tex=void 0,this.result_value=void 0,"number"===typeof e?(this.tex=e.toString(),this.result_value=e):(this.result_value=parseFloat(e),this.tex=e)}return Object(l.a)(t,[{key:"getResult",value:function(){return this.result_value}},{key:"getRank",value:function(){return s.NUMBER}},{key:"getTex",value:function(){return this.tex}},{key:"useExplicitTexParentheses",value:function(){return!1}}]),t}();function S(t,e){return e?"\\left(".concat(t.getTex(),"\\right)"):"".concat(t.getTex())}var R=function(){function t(e,n,s,i,c,a,r){Object(o.a)(this,t),this.rank=s,this.associative=i,this.left=a,this.right=r,this.tex_formula=void 0,this.result_value=void 0,this.explicitTexParentheses=void 0,this.explicitTexParentheses=c,this.tex_formula=this.buildTex(e),this.result_value=n(a.getResult(),r.getResult())}return Object(l.a)(t,[{key:"getResult",value:function(){return this.result_value}},{key:"getRank",value:function(){return this.rank}},{key:"getTex",value:function(){return this.tex_formula}},{key:"useExplicitTexParentheses",value:function(){return this.explicitTexParentheses}},{key:"needLeftParenthesis",value:function(){return this.rank>this.left.getRank()}},{key:"needRightParenthesis",value:function(){return this.rank>this.right.getRank()||!this.associative&&this.rank===this.right.getRank()}},{key:"buildTex",value:function(t){return t(S(this.left,this.needLeftParenthesis()&&this.left.useExplicitTexParentheses()),S(this.right,this.needRightParenthesis()&&this.right.useExplicitTexParentheses()),this.left,this.right)}}]),t}(),_=function(){function t(e,n,s){Object(o.a)(this,t),this.arg=s,this.tex_formula=void 0,this.result_value=void 0,this.tex_formula=n(S(s,s.useExplicitTexParentheses()),s),this.result_value=e(s.getResult())}return Object(l.a)(t,[{key:"getRank",value:function(){return s.FUNC}},{key:"getTex",value:function(){return this.tex_formula}},{key:"useExplicitTexParentheses",value:function(){return!1}},{key:"getResult",value:function(){return this.result_value}}]),t}(),I=function(){function t(e){Object(o.a)(this,t),this.arg=e,this.tex_formula=void 0,this.result_value=void 0,this.tex_formula="{-".concat(S(e,e.useExplicitTexParentheses()),"}"),this.result_value=-e.getResult()}return Object(l.a)(t,[{key:"getRank",value:function(){return s.FUNC}},{key:"getTex",value:function(){return this.tex_formula}},{key:"useExplicitTexParentheses",value:function(){return!0}},{key:"getResult",value:function(){return this.result_value}},{key:"getArg",value:function(){return this.arg}}]),t}();var D=function(){function t(){Object(o.a)(this,t)}return Object(l.a)(t,null,[{key:"buildExpression",value:function(t){for(var e,n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];return(e=this.operationsTable[t]).build.apply(e,s)}},{key:"operandsNumber",value:function(t){return this.operationsTable[t].operandsNumber}},{key:"defined",value:function(t){return t in this.operationsTable}}]),t}();D.operationsTable={"+":{operandsNumber:2,build:function(t,e){return new R((function(t,e){return"".concat(t,"+").concat(e)}),(function(t,e){return t+e}),s.PLUS_MINUS,!0,!0,t,e)}},"-":{operandsNumber:2,build:function(t,e){return new R((function(t,e){return"".concat(t,"-").concat(e)}),(function(t,e){return t-e}),s.PLUS_MINUS,!1,!0,t,e)}},"*":{operandsNumber:2,build:function(t,e){return new R((function(t,e){return"".concat(t,"\\times").concat(e)}),(function(t,e){return t*e}),s.MULT__DIV,!0,!0,t,e)}},"/":{operandsNumber:2,build:function(t,e){return new R((function(t,e,n,s){return"\\frac{".concat(n.getTex(),"}{").concat(s.getTex(),"}")}),(function(t,e){return t/e}),s.MULT__DIV,!1,!0,t,e)}},sqrt:{operandsNumber:1,build:function(t){return new _((function(t){return Math.sqrt(t)}),(function(t,e){return"\\sqrt{".concat(e.getTex(),"}")}),t)}},sqr:{operandsNumber:1,build:function(t){return new _((function(t){return t*t}),(function(t){return"{".concat(t,"}^2")}),t)}},uminus:{operandsNumber:1,build:function(t){return(e=t)instanceof I?e.getArg():new I(e);var e}}};var T,w=n(23);!function(t){t[t.ADD_NUMBER=0]="ADD_NUMBER",t[t.OPERATION=1]="OPERATION",t[t.ENTER=2]="ENTER",t[t.SWAP=3]="SWAP",t[t.BS=4]="BS",t[t.DEL=5]="DEL",t[t.CLEAR=6]="CLEAR"}(T||(T={}));var A=new(function(){function t(){var e=this;Object(o.a)(this,t),this.editorText=new O.a,this.expressionStack=new O.a,this.calcInputEvent=new O.a,this.stackResult=new f.a(NaN),this.editor=new m,this.stack=[],this.history=[],this.calcInputEvent.subscribe(this.processInputEvent.bind(this)),this.editor.expression.subscribe(this.editorText),this.expressionStack.pipe(Object(w.a)((function(t){return t[e.stack.length-1]?t[e.stack.length-1].result:NaN}))).subscribe(this.stackResult)}return Object(l.a)(t,[{key:"getStack",value:function(){return this.stack.map((function(t){return{texFormula:t.getTex(),result:t.getResult()}}))}},{key:"backSpace",value:function(){this.editor.notEmpty()?this.editor.addSymbol(m.BS_SYMBOL):this.popHistory()&&this.expressionStack.next(this.getStack())}},{key:"popHistory",value:function(){var t=this.history.pop();return!!t&&(this.stack=t,!0)}},{key:"stashHistory",value:function(){this.history.push(Object(v.a)(this.stack))}},{key:"push",value:function(){this.editor.notEmpty()?(this.stashHistory(),this.stack.push(this.editorExpression()),this.editor.addSymbol(m.CLEAR_SYMBOL),this.expressionStack.next(this.getStack())):this.stack.length>0&&(this.stashHistory(),this.stack.push(this.stack[this.stack.length-1]),this.expressionStack.next(this.getStack()))}},{key:"swap",value:function(){if(this.stack.length>=2){this.stashHistory();var t=[this.stack[this.stack.length-2],this.stack[this.stack.length-1]];this.stack[this.stack.length-1]=t[0],this.stack[this.stack.length-2]=t[1],this.expressionStack.next(this.getStack())}}},{key:"clear",value:function(){this.editor.addSymbol(m.CLEAR_SYMBOL),this.history=[],this.stack=[],this.expressionStack.next(this.getStack())}},{key:"del",value:function(){this.editor.notEmpty()?this.editor.addSymbol(m.CLEAR_SYMBOL):this.stack.length>0&&(this.stashHistory(),this.stack.pop(),this.expressionStack.next(this.getStack()))}},{key:"editorExpression",value:function(){return new N(this.editor.getInput())}},{key:"addOperation",value:function(t){if(D.defined(t)){var e=D.operandsNumber(t)-(this.editor.notEmpty()?1:0);if(!(e>this.stack.length)){this.stashHistory();var n=this.stack.splice(-e,e);this.editor.notEmpty()&&(n.push(this.editorExpression()),this.editor.addSymbol(m.CLEAR_SYMBOL)),this.stack.push(D.buildExpression.apply(D,[t].concat(Object(v.a)(n)))),this.expressionStack.next(this.getStack())}}}},{key:"addNumber",value:function(t){this.editor.addSymbol(t)}},{key:"processInputEvent",value:function(t){switch(t.type){case T.ADD_NUMBER:t.payload&&this.addNumber(t.payload);break;case T.OPERATION:t.payload&&this.addOperation(t.payload);break;case T.DEL:this.del();break;case T.CLEAR:this.clear();break;case T.BS:this.backSpace();break;case T.ENTER:this.push();break;case T.SWAP:this.swap()}}}]),t}());var B=function(){return Object(i.jsxs)("div",{className:"App",children:[Object(i.jsx)(x,{subject:A.expressionStack}),Object(i.jsx)(k,{subject:A.editorText}),Object(i.jsx)("div",{className:"Pad",children:Object(i.jsx)("table",{className:"Buttons",children:Object(i.jsxs)("tbody",{children:[Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{className:"Num",children:Object(i.jsx)(d,{caption:"7",tag:"7",keybind:"7",action:T.ADD_NUMBER,subject:A.calcInputEvent})}),Object(i.jsx)("td",{className:"Num",children:Object(i.jsx)(d,{caption:"8",tag:"8",keybind:"8",action:T.ADD_NUMBER,subject:A.calcInputEvent})}),Object(i.jsx)("td",{className:"Num",children:Object(i.jsx)(d,{caption:"9",tag:"9",keybind:"9",action:T.ADD_NUMBER,subject:A.calcInputEvent})}),Object(i.jsx)("td",{children:Object(i.jsx)(d,{caption:"/",tag:"/",keybind:"/",action:T.OPERATION,subject:A.calcInputEvent})}),Object(i.jsx)("td",{children:Object(i.jsx)(d,{caption:"<-",keybind:"Backspace",action:T.BS,subject:A.calcInputEvent})})]}),Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{className:"Num",children:Object(i.jsx)(d,{caption:"4",tag:"4",keybind:"4",action:T.ADD_NUMBER,subject:A.calcInputEvent})}),Object(i.jsx)("td",{className:"Num",children:Object(i.jsx)(d,{caption:"5",tag:"5",keybind:"5",action:T.ADD_NUMBER,subject:A.calcInputEvent})}),Object(i.jsx)("td",{className:"Num",children:Object(i.jsx)(d,{caption:"6",tag:"6",keybind:"6",action:T.ADD_NUMBER,subject:A.calcInputEvent})}),Object(i.jsx)("td",{children:Object(i.jsx)(d,{caption:"*",tag:"*",keybind:"*",action:T.OPERATION,subject:A.calcInputEvent})}),Object(i.jsx)("td",{children:Object(i.jsx)(d,{caption:"Del",tag:"clear",keybind:"Delete",action:T.DEL,subject:A.calcInputEvent})})]}),Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{className:"Num",children:Object(i.jsx)(d,{caption:"1",tag:"1",keybind:"1",action:T.ADD_NUMBER,subject:A.calcInputEvent})}),Object(i.jsx)("td",{className:"Num",children:Object(i.jsx)(d,{caption:"2",tag:"2",keybind:"2",action:T.ADD_NUMBER,subject:A.calcInputEvent})}),Object(i.jsx)("td",{className:"Num",children:Object(i.jsx)(d,{caption:"3",tag:"3",keybind:"3",action:T.ADD_NUMBER,subject:A.calcInputEvent})}),Object(i.jsx)("td",{children:Object(i.jsx)(d,{caption:"-",tag:"-",keybind:"-",action:T.OPERATION,subject:A.calcInputEvent})}),Object(i.jsx)("td",{children:Object(i.jsx)(d,{caption:"Swap",keybind:"PageDown",action:T.SWAP,subject:A.calcInputEvent})})]}),Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{className:"Num",children:Object(i.jsx)(d,{caption:"0",tag:"0",keybind:"0",action:T.ADD_NUMBER,subject:A.calcInputEvent})}),Object(i.jsx)("td",{className:"Num",children:Object(i.jsx)(d,{caption:".",tag:".",keybind:".",action:T.ADD_NUMBER,subject:A.calcInputEvent})}),Object(i.jsx)("td",{}),Object(i.jsx)("td",{children:Object(i.jsx)(d,{caption:"+",tag:"+",keybind:"+",action:T.OPERATION,subject:A.calcInputEvent})}),Object(i.jsx)("td",{children:Object(i.jsx)(d,{caption:"Reset",keybind:"Escape",action:T.CLEAR,subject:A.calcInputEvent})})]}),Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:Object(i.jsx)(d,{caption:"\u221a",tag:"sqrt",keybind:"\\",action:T.OPERATION,subject:A.calcInputEvent})}),Object(i.jsx)("td",{children:Object(i.jsx)(d,{caption:"x\xb2",tag:"sqr",action:T.OPERATION,subject:A.calcInputEvent})}),Object(i.jsx)("td",{children:Object(i.jsx)(d,{caption:"-x",tag:"uminus",action:T.OPERATION,subject:A.calcInputEvent})}),Object(i.jsx)("td",{}),Object(i.jsx)("td",{children:Object(i.jsx)(d,{caption:"Enter",keybind:"Enter",action:T.ENTER,subject:A.calcInputEvent})})]})]})})})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));window.document.addEventListener("paste",(function(t){console.log("paste action initiated"),t.clipboardData&&console.log(t.clipboardData.getData("text/plain")),t.preventDefault()})),window.document.addEventListener("copy",(function(t){console.log("copy action initiated"),t.clipboardData&&t.clipboardData.setData("text/plain","Hello, world2!"),t.preventDefault()})),u.a.render(Object(i.jsx)(B,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[39,1,2]]]);
//# sourceMappingURL=main.f4b8b86b.chunk.js.map